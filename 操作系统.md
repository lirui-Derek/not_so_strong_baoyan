# 1、进程和线程和程序的区别

进程：进程是系统资源分配和调度的独立单位，是系统中并发执行的单位

线程：线程是进程的一个实体，也是CPU调度和分配的基本单位，是比进程更小的基本单位。

**线程和进程最大的不同在于基本上各进程是独立的，而各线程则不一定，因为同一进程中的线程极有可能会相互影响。**

**不同进程地址空间相互独立，同一进程内的线程共享同一地址空间**。

**进程间通信较为复杂。线程通信相对简单**

程序：是为完成特定任务，用某种语言编写的一组指令[集合](https://so.csdn.net/so/search?q=集合&spm=1001.2101.3001.7020)，即静态的代码。进程和线程是动态的。



# 2、进程通信

1、管道——半双工，**管道只允许单向通信，半双工**，数据只能向一个方向流动，需要双方通信时，需要建立两个管道。一个进程写数据另一个进程读数据，并且按照先进先出的顺序。管道随进程，进程在管道在，进程消失管道对应的端口也关闭，两个进程都消失管道也消失。通常只在父子进程之间通信，速度慢。



2、消息队列——消息队列可以认为是一个消息链表，存储在内核中。 **发送方把消息发送到消息队列，接收方从消息队列取消息。**他与管道不同的是管道的队列存储在硬盘中访问速度慢，而消息队列的队列存放在内存中速度快。管道是数据流形式，而**消息队列是数据块形式，类似与TCP和UDP**。消息队列允许一个或多个进程向它写入与读取消息，所以需要唯一标识符来确定哪个。进程间通过消息队列通信，主要是：创建或打开消息队列，添加消息，读取消息和控制消息队列。容量受限。



3、信号量——信号量实质上就是一个标识可用资源数量的计数器，可以理解为一个简单的锁，不能传递复杂消息。一个共享资源中由一个信号量标识，当一个进程访问的时候，这个信号量就-1，变为0，这时其他进程就不能访问，当进程释放共享资源，信号量就+1，大于0，这时其他进程可以访问。他一般和共享内存配合使用实现数据的同步防止出现修改数据错误的问题。常作为一种锁机制



4、共享内存——映射一段能被其他进程所访问的内存，这是最高效的进程间通信IPC方式。它使得多个进程可以访问同一块内存空间，不同进程可以及时看到对方进程中对共享内存中数据得更新。**但是这种方式需要依靠某种同步操作保证数据正确性，如锁和信号量等；**采用共享内存进行通信的一个主要好处是效率高，因为进程可以直接读写内存，而不需要任何数据的拷贝，对于像管道和消息队里等通信方式，则需要在内核和用户空间进行四次的数据拷贝，而共享内存则只拷贝两次：一次从输入文件到共享内存区，另一次从共享内存到输出文件。和锁来配合使用。



# 3、进程调度策略

1、FIFO

2、最短任务优先

3、最短完成时间优先

4、轮转法：每个任务执行一段时间。轮转时间要考虑上下文切换成本设计轮转时间。时间公平，时间片太小，导致进程切换太频繁，进程切换时间过长，那么实时性就不能得到保证。

5、比例份额调度

6、多级反馈队列：

1. 将任务放在不同队列中，每个队列有优先级，比如三个优先级队列，高中低。先执行高优先级队列的进程。

2. 对于高优先级队列中的多个进程，我们使用时间片轮转调度。

3. 新工作进入系统放到最高优先级。

4. 工作用完一个时间片，降低优先级。

   

   ## 调度算法的评价标准

   1. CPU利用率
   2. 系统吞吐率
   3. 周转时间
   4. 等待时间
   5. 响应时间

   

# 4、进程的状态

三种基本状态：就绪、执行、阻塞

五种状态：创建、就绪、执行、阻塞、终止



# 5、PCB——进程控制块

程序段、相关数据段和PCB组成了进程实体。

PCB是进程存在的唯一标志。

![image-20220803164241470](C:\Users\lirui\AppData\Roaming\Typora\typora-user-images\image-20220803164241470.png)



# 6、多线程

线程是处理机的独立调度单位，多个线程是可以并发执行的。

线程可以分为两类：

​								用户级线程：有关线程管理的所有工作都由于由应用程序完成，内核意识不到线程的存在。

​								内核级线程：线程管理的所有工作由内核完成，应用程序没有进行线程管理的代码，只有一个到内核级线程的编程接口。

TCB：线程控制块



# 7、处理机调度

​		在多道程序系统中，进程的数量往往多于处理机的个数，因此进程争用处理机的情况在所难免。

​		调度的层次：三级调度：（1）作业调度；（2）中级调度；（3）进程调度



​		进程调度方式：抢占式、非抢占式

​		调度算法：
1、先来先服务（FCFS）调度算法

2、短作业优先算法

3、优先级调度算法

4、高响应比优先调度算法

5、时间片轮转调度算法

6、多级反馈队列调度算法



![image-20220804163528865](C:\Users\lirui\AppData\Roaming\Typora\typora-user-images\image-20220804163528865.png)

# 6、死锁的条件

**互斥条件、请求和保持条件、不剥夺条件、循环等待条件。**

死锁检测与解除

一个简单的死锁检测算法
给每个进程、每个资源指定唯一编号；设置一张资源分配表记录各进程与其占用资源之间的关系；设置一张进程等待表记录各进程与要申请资源之间的关系。从资源等待表出发，看有没有形成等待的环路。即可以利用资源分配图的思想来检测是否有死锁发生。



死锁预防

破坏**互斥条件、请求和保持条件、不剥夺条件、循环等待条件。**



死锁避免
死锁避免的重要是以最小的代价恢复系统的运行，具体的死锁解除的方法有几个：

(1)撤消所有死锁进程，代价较大；

(2)进程回退（Roll back）再启动，进程在执行过程中，系统会为进程记录一些中间节点，当出现死锁的时候进行回退再一起重新运行，由于需要记录每个进程的现场，所以系统代价也比较大；

(3)按照某种原则逐一撤消死锁进程，直到没有死锁；

(4)按照某种原则逐一抢占资源（资源被抢占的进程必须回退到之前的对应状态），直到没有死锁。

进一步可通过银行家算法和哲学家就餐问题来了解死锁的避免。



# 7、分段和分页的具体区别

```
1、段是信息的逻辑单位，它是根据用户的需要划分的，因此段对用户是可见的。页是信息的物理单位，是为了管理主存的方便而划分的，对用户是透明的；

2、段的大小不固定，有它所完成的功能决定。页的大小固定，由系统决定

3、段向用户提供二维地址空间。页向用户提供的是一维地址空间

4、段是信息的逻辑单位，便于存储保护和信息的共享。页的保护和共享受到限制

```



# 8、虚拟内存

```
虚拟内存是计算机系统内存管理的一种技术。它使得应用程序认为它拥有连续可用的内存（一个连续完整的地址空间），而实际上，它通常是被分隔成多个物理内存碎片，还有部分暂时存储在外部磁盘存储器上，在需要时进行数据交换。

与没有使用虚拟内存技术的系统相比，使用这种技术的系统使得大型程序的编写变得更容易，对真正的物理内存（例如 RAM）的使用也更有效率。

实现技术：
		请求分页存储管理
		请求分段存储管理
		请求段页式管理
```



# 9、程序的五大内存区分配

### 一、堆区

​		程序员自己***手动***申请和释放，用malloc函数申请，用free函数释放。存储对象，数组，非静态变量。

### 二、栈区

​		由[编译器](https://so.csdn.net/so/search?q=编译器&spm=1001.2101.3001.7020)自动分配释放，存放函数的参数值，局部变量的值等。操作方式类似数据结构中的栈。

### 三、全局区

​		全局变量和静态变量的存储是放 在一块的，初始化的全局变量和静态变量在一块区域，未初始化的全局变量和未初始化的静态变量在相邻的另一块区域。程序结束后由系统释放。

### 四、文字常量区

​		常量字符串

### 五、程序代码区

​		函数体的二进制代码

# 10、页面替换算法

1、FIFO：先进先出

2、LRU：最近最久未访问原则

3、LFU：最不常用算法

4、CLOCK算法：时钟置换算法，使用位



# 11、硬链接和软链接



# 12、用户态和内核态

**用户态**：处于用户态的CPU只能受限地访问内存，并且不允许访问外围设备，用户态下的CPU不允许独占，也就是说CPU能够被其他程序获取。

**内核态**：处于内核态的CPU可以访问任意的数据，包括外围设备，比如网卡、硬盘等，处于内核态的CPU可以从一个程序切换到另外一个程序，并且占用CPU不会发生抢占情况，一般处于特权级0的状态称之为内核态。

### 用户态和内核态是如何切换的？

操作系统一般是通过中断来从用户态切换到内核态的。

中断分为硬件中断和软件中断，我们这里说的是软件中断，软件中断通常是一条指令，使用这条指令用户可以手动触发某个中断。

## 系统调用：

陷阱指令(trap instruction)

- 当系统发起调用时通常通过一个称为陷阱(trap)的特殊硬件指令，硬件将控制转移到预先指定的陷阱处理程序（trap handler），并同时将特权级别提升到内核模式（kernel mode）。

- 在内核模式下，操作系统可以完全访问系统的硬件，因此可以执行诸如发起I/O请求或为程序提供更多内存等功能。

- 当操作系统完成请求的服务时，它通过特殊的陷阱返回（return-from-trap）指令将控制权交还给用户，该指令返回到用户模式，同时将控制权交还给应用程序，回到应用离开的地方。



# 13、创建进程首先要将程序和数据装入内存。将用户源程序变为可在内存中执行的程序，通常需要以下几个步骤：

- 编译：将编译程序将用户源代码编译成若干目标模块。
- 链接：由链接程序将编译后形成的一组目标模块及所需的库函数链接在一起，形成一个完整的装入模块。静态链接、装入时动态链接、运行时动态链接。
- 装入：由装入程序将装入模块装入内存运行。绝对装入、可重定位装入、动态运行时装入。





# 14、内存管理

## 1、连续分配管理方式

- 单一连续分配

  内存在此方式下分为系统区和用户区，系统区仅供操作系统使用，通常在低地址部分；用户区是为用户提供的、除系统区之外的内存空间。

- 固定分区分配

  用户内存空间划分为若干固定大小的区域，每个分区只装入一道作业。

- 动态分区分配

  - 首次适应算法
  - 最佳适应算法
  - 最坏适应算法
  - 邻近适应算法

## 2、非连续分配管理方式

分页存储管理方式

分段存储管理方式



# 15、虚拟内存管理

定义：基于局部性原理，在程序装入时，将程序的一部分装入内存，而将其余部分留在外存，就可启动程序执行。在程序执行过程中，当所访问的信息不在内存时，由操作系统将所需要的部分调入内存，然后继续执行程序。另一方面，操作系统将内存中暂时不使用的内容换出到外存上，从而腾出空间存放将要调入内存的信息。这样系统好像为用户提供了一个比实际内存大得多的存储器，称为虚拟存储器。

虚拟存储器三个主要特征：

- 多次性。无须在作业运行时一次性全部装入内存。
- 对换性。对换性是指无须在作业运行时一直常驻内存，而允许在作业的运行过程中，进行换进换出。
- 虚拟性。逻辑上扩充内存容量



## 请求分页存储管理方式

​		页面置换算法：

​		最佳置换算法



## 请求分段存储管理方式



![image-20220808093703930](C:\Users\lirui\AppData\Roaming\Typora\typora-user-images\image-20220808093703930.png)

1、页是信息的物理单位，为实现离散分配方式，提高内存的利用率，为了系统管理的需要。

​		段是信息的逻辑单位，分段的目的是为了更好地满足用户的需要。

2、页的大小固定且由系统决定，段长不固定。

3、地址空间是一维的，单一的线性地址空间，程序利用一个记忆符即可表示一个地址。

​	作业地址空间是二维的，程序员在标识一个地址时，既需要段号，又需要给出段内地址。

4、分页有内部碎片，无外部碎片。

​		分段有外部碎片，无内部碎片

# 16、

# 17、调入页面的时机

预调页策略

请求调页策略



# 18、文件管理

操作系统维护一个   打开文件表（open-file table）。当用户需要一个文件操作时，可通过该表的一个索引指定文件，省略了搜索环节。当文件不再使用时，进程可以关闭它，操作系统从打开文件表中删除这一条目。

文件打开计数器（open Count），记录多少进程打开了该文件。

文件控制块（FCB）：

- 文件指针。
- 文件打开计数。
- 文件磁盘位置。
- 访问权限。

### 文件的逻辑结构：

无结构文件（流文件，字节流）

有结构文件（记录式文件）

- 顺序文件
- 索引文件
- 索引顺序文件
- 直接文件或散列文件



目录结构

​		文件控制块和索引结点

![image-20220808110837654](C:\Users\lirui\AppData\Roaming\Typora\typora-user-images\image-20220808110837654.png)

## 目录结构

- 单级目录
- 两级目录
- 多级目录（树形目录结构）



文件共享

1、基于索引结点的共享方式（硬链接）

​		两个或多个用户要共享一个子目录或文件时，必须要共享文件或子目录链接到两个或多个用户的目录中，才能方便地找到该文件。

​		![image-20220808154822589](C:\Users\lirui\AppData\Roaming\Typora\typora-user-images\image-20220808154822589.png)

​	2、利用符号链实现文件共享（软链接）

​		为使用户B能共享用户A的一个文件F，可以由系统创建一个LINK类型的新文件，也取名为F，并将文件F写入用户B的目录中，以实现用户B的目录与文件F的链接。在新文件中只包含被链接文件F的路径名。这样的链接方法被称为符号链接。		快捷方式。





## 文件分配方式

1、连续分配

2、链接分配

3、索引分配



空闲块管理：成组链接法



# 19、计算机开机过程

- 启动BIOS（基本输入输出系统），进行硬件自检和初始化，BIOS按照启动顺序开始搜索可引导的存储设备，找到后，会将存储设备中可引导的存储设备，找到后，会将存储设备中的引导扇区，开始系统引导。

- 系统引导。找到操作系统。

- 启动系统。当有多个操作系统时，会运行启动管理器（Boot Loader），让用户选择启动操作系统；当只有一个操作系统时，就会直接从激活分区中启动操作系统。

- 初始化系统。操作系统启动后，控制权就从 boot loader 转交给了操作系统，之后，操作系统的内核首先被载入缓存，随后会运行初始化进程进行操作系统的初始化。

  





# 操作系统复习

## 1、操作系统的定义：

​		操作系统是计算机软硬件资源的组织者和管理者，它是一组程序的集合，合理地对各类作业进行调度，方便用户使用，作为用户与计算机硬件系统之间的接口。

英语回答：

​		The operating system is the organizer and manager of computer software and hardware resources. It is a collection of programs that reasonably schedule various jobs for the convenience of users. It acts as the interface between the user and the computer hardware system. 



## 2、操作系统的特征

- 并发：两个或多个事件在同一时间间隔发生。

- 共享：系统中的资源可供内存中多个并发执行的进程共同使用。互斥共享方式（一段时间内，只允许一个进程访问该资源）、同时访问方式。

- 虚拟：

- 异步：进程是并发执行的，进程是以人们不可预知的速度向前推进的，此即进程的异步性。因此需要进程同步机制，协调进程运行。

  

## 3、操作系统的主要功能

1. 处理机管理——》对进程的管理
2. 存储器管理（内存管理）
3. 文件管理（文件系统）
4. 设备管理

英语：

​		The operating system is the organizer and manager of computer software and hardware resources. It is a collection of programs that reasonably schedule various jobs for the convenience of users, mainly including **Processor management**, **Memory management**, **File management** and **Device management**.







